@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    /* --- Font --- */
    --font: 'Noto Sans KR', sans-serif;

    /* --- Font Scale (14px = md) --- */
    --text-xs:  10px;
    --text-sm:  12px;
    --text-md:  14px;
    --text-lg:  16px;
    --text-xl:  18px;
    --text-2xl: 22px;
    --text-3xl: 26px;

    /* --- Neutrals (stone/slate) --- */
    --bg-page:        #F4F1EE;
    --bg-surface:     #FFFFFF;
    --bg-muted:       #EBE7E3;
    --border:         #D6D0CA;
    --border-strong:  #B8B0A7;
    --text-primary:   #2E3A40;
    --text-secondary: #64747B;
    --text-disabled:  #9C9589;
    --stone-400:      #A8A09A;
    --slate-600:      #64747B;

    /* --- Accent (dull orange) --- */
    --accent:         #C96B3E;
    --accent-hover:   #B85C34;
    --accent-muted:   #F0DDD3;
    --accent-text:    #C96B3E;

    /* --- Semantic --- */
    --success:        #5A8A6A;
    --success-muted:  #E6F0EA;
    --error:          #B04A3A;
    --error-muted:    #F5E4E1;
    --info:           #4A7C9C;
    --info-muted:     #E1EBF0;

    /* --- Spacing --- */
    --sp-1: 4px;  --sp-2: 8px;   --sp-3: 12px;  --sp-4: 16px;
    --sp-5: 20px; --sp-6: 24px;  --sp-8: 32px;  --sp-10: 40px;
    --sp-12: 48px;

    /* --- Border Radius --- */
    --radius-sm:   4px;
    --radius-md:   6px;
    --radius-lg:   8px;
    --radius-full: 9999px;
}

/* 다크모드 (Native Stone 어두운 팔레트) */
[data-theme="dark"] {
    --bg-page:        #1C1917;
    --bg-surface:     #292524;
    --bg-muted:       #3C3532;
    --border:         #524842;
    --border-strong:  #6B5F56;
    --text-primary:   #F5F5F4;
    --text-secondary: #A8A29E;
    --text-disabled:  #78716C;
    --stone-400:      #A8A29E;
    --slate-600:      #94A3B8;

    --accent:         #D97846;
    --accent-hover:   #C96B3E;
    --accent-muted:   #4A332A;
}

body {
    font-family: var(--font);
    font-size: var(--text-md);
    line-height: 1.5;
    color: var(--text-primary);
    background: var(--bg-page);
    padding: 20px;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
}

header {
    margin-bottom: var(--sp-6);
    padding-bottom: var(--sp-4);
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

h1 {
    font-size: var(--text-lg);
    font-weight: 700;
    color: var(--text-primary);
}

.header-actions {
    display: flex;
    gap: var(--sp-3);
}

.icon-btn {
    width: 40px;
    height: 40px;
    padding: 0;
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: 700;
    background: var(--bg-surface);
    border: 1px solid var(--border);
    cursor: pointer;
    transition: all 0.15s;
}

.icon-btn:hover {
    background: var(--bg-muted);
    border-color: var(--border-strong);
}

.controls {
    display: flex;
    gap: var(--sp-5);
    margin-bottom: var(--sp-5);
    flex-wrap: wrap;
    align-items: center;
}

.control-group {
    display: flex;
    align-items: center;
    gap: 8px;
}

label {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    white-space: nowrap;
}

input[type="checkbox"] {
    width: 16px;
    height: 16px;
    cursor: pointer;
}

button, .file-input-label {
    padding: 8px 18px;
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    font: 500 var(--text-md) var(--font);
    cursor: pointer;
    transition: all 0.15s;
    color: var(--text-primary);
}

button:hover, .file-input-label:hover {
    background: var(--bg-muted);
    border-color: var(--border-strong);
}

button.primary {
    background: var(--accent);
    color: white;
    border-color: var(--accent);
}

button.primary:hover {
    background: var(--accent-hover);
}

button.copied {
    background: var(--success) !important;
    color: white !important;
    border-color: var(--success) !important;
}

.file-input-label {
    display: inline-block;
}

input[type="file"] {
    display: none;
}

.workspace {
    display: block;
    margin-bottom: 20px;
}

.panel {
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    overflow: hidden;
}

.panel-header {
    padding: var(--sp-3) var(--sp-4);
    background: var(--bg-surface);
    border-bottom: 1px solid var(--border);
    font-weight: 500;
    font-size: var(--text-sm);
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    user-select: none;
}

.panel-header.collapsible::before {
    content: '▼';
    margin-right: 8px;
    font-size: 10px;
    transition: transform 0.2s;
}

.panel-header.collapsed::before {
    transform: rotate(-90deg);
}

.panel-actions {
    display: flex;
    gap: 8px;
}

.panel-actions button {
    padding: 4px 12px;
    font-size: 12px;
}

.panel-header-actions {
    display: flex;
    gap: var(--sp-3);
    align-items: center;
}

.panel-header-actions label {
    display: flex;
    align-items: center;
    gap: var(--sp-1);
    font-size: var(--text-xs);
    color: var(--text-secondary);
}

.panel-header-actions button {
    padding: 6px 16px;
    font-size: var(--text-sm);
}

.css-menubar {
    display: flex;
    gap: var(--sp-3);
    padding: var(--sp-4);
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    margin-bottom: var(--sp-5);
    align-items: center;
}

.css-menubar button {
    padding: 6px 14px;
    font-size: var(--text-sm);
}

.css-toggle {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-md);
}

.dropdown {
    position: relative;
}

.dropdown-trigger::after {
    content: '';
    margin-left: 4px;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 4px;
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    display: none;
    flex-direction: column;
    min-width: 150px;
    z-index: 100;
}

.dropdown.active .dropdown-menu {
    display: flex;
}

.dropdown-menu button {
    text-align: left;
    border: none;
    border-radius: 0;
    padding: var(--sp-3) var(--sp-4);
}

.dropdown-menu button:hover {
    background: var(--bg-muted);
}

.dropdown-menu button:first-child {
    border-radius: var(--radius-md) var(--radius-md) 0 0;
}

.dropdown-menu button:last-child {
    border-radius: 0 0 var(--radius-md) var(--radius-md);
}

.file-trigger {
    cursor: pointer;
}

.panel-content {
    transition: max-height 0.3s ease;
    overflow: hidden;
}

.panel-content.collapsed {
    max-height: 0 !important;
}

textarea {
    width: 100%;
    height: 400px;
    padding: 16px;
    border: none;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 12px;
    line-height: 1.6;
    resize: vertical;
    background: white;
}

.preview-frame {
    width: 100%;
    height: 400px;
    border: none;
    background: white;
}

.tabs {
    display: flex;
    border-bottom: 1px solid var(--border);
    background: var(--bg-surface);
    gap: 0;
}

.tab {
    padding: 12px 20px;
    border: none;
    border-radius: 0;
    background: transparent;
    cursor: pointer;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--text-secondary);
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
    position: relative;
}

.tab:hover {
    color: var(--text-primary);
    background: transparent;
}

.tab.active {
    color: var(--accent);
    border-bottom-color: var(--accent);
    background: transparent;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.output-section {
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    overflow: hidden;
}

pre {
    margin: 0;
    padding: 16px;
    overflow: auto;
    max-height: 500px;
    background: white;
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: 12px;
    line-height: 1.6;
}

.empty-state {
    padding: 60px 20px;
    text-align: center;
    color: var(--text-secondary);
    font-size: var(--text-sm);
}

/* 모달 (Native Stone: no shadow, border only) */
dialog {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    margin: 0;
    max-width: 800px;
    width: 90vw;
    max-height: 80vh;
    border: 1px solid var(--border-strong);
    border-radius: var(--radius-lg);
    padding: 0;
    background: var(--bg-surface);
    overflow: hidden;
}

dialog::backdrop {
    background: rgba(0, 0, 0, 0.5);
}

.modal-content {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--sp-5);
    border-bottom: 1px solid var(--border);
}

.modal-header h2 {
    font-size: var(--text-xl);
    font-weight: 600;
    margin: 0;
    color: var(--text-primary);
}

.close-btn {
    width: 32px;
    height: 32px;
    padding: 0;
    border-radius: var(--radius-full);
    font-size: 20px;
    line-height: 1;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-secondary);
    cursor: pointer;
}

.close-btn:hover {
    background: var(--bg-muted);
    color: var(--text-primary);
    border-color: var(--border-strong);
}

.modal-body {
    flex: 1;
    padding: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.modal-body textarea {
    flex: 1;
    min-height: 400px;
    width: 100%;
    padding: var(--sp-5);
    border: none;
    resize: none;
    overflow-y: auto;
    background: white;
}

.modal-footer {
    display: flex;
    gap: var(--sp-3);
    justify-content: flex-end;
    padding: var(--sp-5);
    border-top: 1px solid var(--border);
    flex-shrink: 0;
}

.modal-footer button {
    padding: 6px 16px;
    font-size: var(--text-sm);
}

/* Split Panes */
.split-panes {
    display: flex;
    flex-direction: row;
    height: calc(100vh - 300px);
    min-height: 600px;
}

.pane-left {
    flex: 1;
    min-width: 300px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
}

.pane-left .panel {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.pane-left textarea {
    flex: 1;
    height: auto;
}

.pane-right {
    flex: 1;
    min-width: 300px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
    position: relative;
}

.pane-right .output-section {
    height: 100%;
    display: flex;
    flex-direction: column;
}

.pane-left.collapsed {
    flex: 0 !important;
    min-width: 0;
    overflow: hidden;
}

.pane-right.collapsed {
    flex: 0 0 0 !important;
    min-width: 0;
    overflow: hidden;
}

.pane-left {
    position: relative;
}

.pane-left.drag-over {
    border: 2px dashed var(--accent);
    background: var(--accent-muted);
}

.pane-left.drag-over::after {
    content: '파일을 놓으세요';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: var(--text-xl);
    color: var(--accent);
    pointer-events: none;
    z-index: 10;
}


/* Tab content 구조 */
.tab-content {
    display: none;
    flex-direction: column;
    height: 100%;
}

.tab-content.active {
    display: flex;
}

.tab-content .panel-header {
    flex-shrink: 0;
}

.tab-content pre {
    flex: 1;
    overflow: auto;
    margin: 0;
    border-top: 1px solid var(--border);
    padding: var(--sp-4);
    background: var(--bg-surface);
}

.toast-container {
    position: fixed;
    bottom: var(--sp-6);
    right: var(--sp-6);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
    pointer-events: none;
}

.toast {
    padding: var(--sp-3) var(--sp-5);
    background: var(--bg-surface);
    border: 1px solid var(--border-strong);
    border-radius: var(--radius-md);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    animation: slideIn 0.3s ease-out, slideOut 0.3s ease-in 2.7s;
    pointer-events: auto;
    min-width: 200px;
}

.toast-success {
    border-color: var(--success);
    background: var(--success-muted);
    color: var(--success);
}

.toast-error {
    border-color: var(--error);
    background: var(--error-muted);
    color: var(--error);
}

.toast-info {
    border-color: var(--info);
    background: var(--info-muted);
    color: var(--info);
}

@keyframes slideIn {
    from {
        transform: translateX(400px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(400px);
        opacity: 0;
    }
}

/* Success Overlay */
.success-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(90, 138, 106, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    pointer-events: none;
    animation: overlayFade 0.8s ease-out;
}

[data-theme="dark"] .success-overlay {
    background: rgba(90, 138, 106, 0.25);
}

.success-overlay-icon {
    width: 80px;
    height: 80px;
    background: var(--success);
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 48px;
    color: white;
    animation: iconPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 8px 24px rgba(90, 138, 106, 0.3);
}

@keyframes overlayFade {
    0% {
        opacity: 0;
    }
    20% {
        opacity: 1;
    }
    80% {
        opacity: 1;
    }
    100% {
        opacity: 0;
    }
}

@keyframes iconPop {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    50% {
        transform: scale(1.1);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* CSS 상태 배지 */
.css-badge {
    padding: 3px 10px;
    font-size: var(--text-xs);
    border-radius: var(--radius-full);
    font-weight: 500;
    white-space: nowrap;
}

.css-badge-builtin {
    background: var(--accent-muted);
    color: var(--accent-text);
    border: 1px solid var(--accent);
}

.css-badge-custom {
    background: var(--info-muted);
    color: var(--info);
    border: 1px solid var(--info);
}

.css-badge-combined {
    background: var(--success-muted);
    color: var(--success);
    border: 1px solid var(--success);
}

.css-badge-none {
    background: var(--bg-muted);
    color: var(--text-disabled);
    border: 1px solid var(--border);
}

/* 변환 버튼 로딩 상태 */
button.primary.loading {
    opacity: 0.7;
    cursor: not-allowed;
}

/* HTML textarea 에러 상태 */
textarea.input-error {
    outline: 2px solid var(--error);
    outline-offset: -2px;
}

/* frame-wrapper: iframe + empty state 오버레이 */
.frame-wrapper {
    flex: 1;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.frame-wrapper iframe {
    flex: 1;
    border: none;
    border-top: 1px solid var(--border);
    width: 100%;
}

.tab-empty-state {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--sp-3);
    background: var(--bg-surface);
    color: var(--text-secondary);
    font-size: var(--text-sm);
    text-align: center;
    line-height: 1.6;
    pointer-events: none;
}

.tab-empty-icon {
    font-size: 36px;
    opacity: 0.3;
}

/* 리사이저 grip */
.resizer {
    width: 12px;
    height: auto;
    background: var(--border);
    cursor: pointer;
    transition: background 0.2s;
    flex-shrink: 0;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

.resizer-grip {
    width: 8px;
    height: 28px;
    fill: var(--text-secondary);
    opacity: 0.6;
    transition: opacity 0.2s;
    flex-shrink: 0;
}

.resizer-arrow {
    display: none;
    position: absolute;
    width: 10px;
    height: 14px;
    color: var(--text-secondary);
}

.resizer:hover .resizer-grip {
    opacity: 0;
}

.resizer:hover .resizer-arrow {
    display: block;
}

.resizer:hover {
    background: var(--accent);
}

.resizer:hover .resizer-arrow {
    color: white;
}

.pane-left.collapsed + .resizer .resizer-arrow-collapse { display: none; }
.pane-left.collapsed + .resizer:hover .resizer-arrow-expand { display: block; }
.pane-left:not(.collapsed) + .resizer:hover .resizer-arrow-collapse { display: block; }
.pane-left:not(.collapsed) + .resizer:hover .resizer-arrow-expand { display: none; }

/* 단축키 모달 */
.shortcuts-modal {
    max-width: 480px;
}

.shortcuts-body {
    padding: var(--sp-5);
}

.shortcuts-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--text-sm);
}

.shortcuts-table th {
    text-align: left;
    padding: var(--sp-2) var(--sp-4);
    color: var(--text-secondary);
    border-bottom: 1px solid var(--border);
    font-weight: 500;
}

.shortcuts-table td {
    padding: var(--sp-3) var(--sp-4);
    border-bottom: 1px solid var(--border);
    vertical-align: middle;
}

.shortcuts-table tr:last-child td {
    border-bottom: none;
}

kbd {
    display: inline-block;
    padding: 2px 6px;
    background: var(--bg-muted);
    border: 1px solid var(--border-strong);
    border-radius: var(--radius-sm);
    font-family: 'Consolas', 'Monaco', monospace;
    font-size: var(--text-xs);
    color: var(--text-primary);
    line-height: 1.6;
}

/* 히스토리 메타 */
.history-item-meta {
    font-size: var(--text-xs);
    color: var(--text-disabled);
    margin-left: auto;
    margin-right: var(--sp-2);
}

/* History List */
.history-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
    max-height: 500px;
    overflow-y: auto;
}

.history-item {
    padding: var(--sp-4);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.2s;
    background: var(--bg-surface);
}

.history-item:hover {
    background: var(--bg-muted);
    border-color: var(--border-strong);
}

.history-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--sp-2);
}

.history-item-time {
    font-size: var(--text-sm);
    color: var(--text-secondary);
}

.history-item-delete {
    padding: 4px 12px;
    font-size: var(--text-xs);
    background: var(--error-muted);
    color: var(--error);
    border: 1px solid var(--error);
    border-radius: var(--radius-sm);
    cursor: pointer;
}

.history-item-delete:hover {
    background: var(--error);
    color: white;
}

.history-item-preview {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.history-item-options {
    display: flex;
    gap: var(--sp-2);
    margin-top: var(--sp-2);
}

.history-item-badge {
    padding: 2px 8px;
    font-size: var(--text-xs);
    background: var(--bg-muted);
    border-radius: var(--radius-sm);
    color: var(--text-secondary);
}

@media (max-width: 768px) {
    .split-panes {
        flex-direction: column !important;
    }

    .resizer {
        width: 100%;
        height: 8px;
        cursor: ns-resize;
    }

    .css-menubar {
        flex-wrap: wrap;
    }

    .panel-header-actions {
        flex-wrap: wrap;
    }

    .pane-left, .pane-right {
        min-width: 0;
    }
}

@media (max-width: 1024px) {
    .workspace {
        grid-template-columns: 1fr;
    }
}
